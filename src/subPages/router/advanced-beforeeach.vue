<script setup lang="ts">
definePage({
  name: 'advanced-beforeeach',
  style: {
    navigationBarTitleText: 'å‰ç½®å®ˆå«',
  },
})

const router = useRouter()

function goBack() {
  router.back()
}
</script>

<template>
  <view class="min-h-screen bg-gray-100 py-3 dark:bg-[var(--wot-dark-background)]">
    <view class="mx-3 mb-3">
      <view class="rounded-3 bg-white px-5 py-6 text-center dark:bg-[var(--wot-dark-background2)]">
        <view class="mb-3 text-8">
          ğŸ›¡ï¸
        </view>
        <view class="mb-2 text-5 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
          å‰ç½®å®ˆå«
        </view>
        <view class="text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
          beforeEach - åœ¨å¯¼èˆªè§¦å‘å‰æ‰§è¡Œ
        </view>
      </view>
    </view>

    <demo-block title="å®ˆå«è¯´æ˜" transparent>
      <view class="space-y-3">
        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            å…¨å±€å®ˆå«
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            å…¨å±€ beforeEach å®ˆå«å®šä¹‰åœ¨ <text class="text-blue-600 font-mono">
              src/router/index.ts
            </text> ä¸­ï¼Œä¼šå¯¹æ‰€æœ‰å¯¼èˆªè¿›è¡Œæ‹¦æˆªã€‚
          </view>
          <view class="border border-blue-200 rounded-2 bg-blue-50 p-3 dark:bg-blue-900/20">
            <view class="flex items-start gap-2">
              <wd-icon name="info-circle" color="#3b82f6" />
              <text class="text-3.5 text-blue-700 dark:text-blue-300">
                å½“å‰é¡µé¢è®¿é—®æ—¶ä¼šè§¦å‘å…¨å±€å®ˆå«çš„ç¡®è®¤å¯¹è¯æ¡†
              </text>
            </view>
          </view>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            åŸºç¡€ç”¨æ³•
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            beforeEach æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼štoï¼ˆç›®æ ‡è·¯ç”±ï¼‰ã€fromï¼ˆæ¥æºè·¯ç”±ï¼‰ã€nextï¼ˆå›è°ƒå‡½æ•°ï¼‰
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]">
            <text class="text-3 text-gray-700 leading-relaxed font-mono dark:text-[var(--wot-dark-color)]">
              router.beforeEach((to, from, next) => {
              console.log('ä»', from.path, 'è·³è½¬åˆ°', to.path)
              next()
              })
            </text>
          </view>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            æ‹¦æˆªå¯¼èˆª
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            é€šè¿‡è°ƒç”¨ next(false) å¯ä»¥å–æ¶ˆå¯¼èˆª
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]">
            <text class="text-3 text-gray-700 leading-relaxed font-mono dark:text-[var(--wot-dark-color)]">
              router.beforeEach((to, from, next) => {
              if (!isAuthenticated) {
              next(false)
              } else {
              next()
              }
              })
            </text>
          </view>
        </view>

        <view class="rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]">
          <view class="mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]">
            é‡å®šå‘
          </view>
          <view class="mb-3 text-3.5 text-gray-600 dark:text-[var(--wot-dark-color2)]">
            é€šè¿‡è°ƒç”¨ next('/path') å¯ä»¥é‡å®šå‘åˆ°å…¶ä»–é¡µé¢
          </view>
          <view class="border border-gray-200 rounded-2 bg-gray-50 p-3 dark:border-[var(--wot-dark-border)] dark:bg-[var(--wot-dark-background3)]">
            <text class="text-3 text-gray-700 leading-relaxed font-mono dark:text-[var(--wot-dark-color)]">
              router.beforeEach((to, from, next) => {
              if (!isAuthenticated) {
              next('/login')
              } else {
              next()
              }
              })
            </text>
          </view>
        </view>
      </view>
    </demo-block>

    <demo-block title="å¯¼èˆª" transparent>
      <wd-button type="warning" block @click="goBack">
        è¿”å›ä¸Šä¸€é¡µ
      </wd-button>
    </demo-block>
  </view>
</template>
